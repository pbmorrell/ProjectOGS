function MemberHomeOnReady(){$(panelEnum.MyEventViewer).hide(),LoadCurrentEventViewer(),LoadEventManager(),$("#modalOverlay").slideReveal({position:"right",push:!1}),$("#searchPanel").slideReveal({position:"right",push:!1}),$("#searchFilterLink").on("touchend",function(a){a.preventDefault(),$("#modalOverlay").data("slide-reveal")?CloseSearchPanel():($("#modalOverlay").slideReveal("show"),$("#searchPanel").slideReveal("show"))}),$("#searchFilterLink").click(function(a){a.preventDefault(),$("#modalOverlay").data("slide-reveal")?CloseSearchPanel():($("#modalOverlay").slideReveal("show"),$("#searchPanel").slideReveal("show"))}),$(".overlayPanelFilterGroup").not("#joinStatusFilterDiv").hide(),DisplaySearchFiltersByCurrentView(),$("#closePanelBtn").click(CloseSearchPanel),$("#gameFilterStartDate").datepicker({inline:!0,changeYear:!0,yearRange:"-0:+1",changeMonth:!0,constrainInput:!0,showButtonPanel:!0,showOtherMonths:!0,dayNamesMin:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dateFormat:"yy-mm-dd",onClose:function(a){$("#gameFilterEndDate").datepicker("option","minDate",a)}}),$("#gameFilterEndDate").datepicker({defaultDate:"+3",inline:!0,changeYear:!0,yearRange:"-0:+1",changeMonth:!0,constrainInput:!0,showButtonPanel:!0,showOtherMonths:!0,dayNamesMin:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dateFormat:"yy-mm-dd",onClose:function(a){$("#gameFilterStartDate").datepicker("option","maxDate",a)}}),$("#gameFilterStartDate").datepicker("setDate",new Date),$("#gameFilterEndDate").datepicker("setDate",addDaysToDate(new Date,3));var a=new Date,b=15-a.getMinutes()%15;a.setMinutes(a.getMinutes()+b);var c={disableTextInput:!1,disableTouchKeyboard:!1,minTime:a,selectOnBlur:!0,useSelect:!1,className:"overlayPanelElement",step:15};$("#gameFilterStartTime").timepicker(c),$("#gameFilterEndTime").timepicker(c),$("#gameFilterStartTime").timepicker("setTime",a),$("#gameFilterEndTime").timepicker("setTime",a),$("#ddlTimeZonesStart").addClass("overlayPanelElement"),$("#ddlTimeZonesEnd").addClass("overlayPanelElement"),$("#btnMobileLeave").click(function(){LeaveSelectedEvents()}),$("#btnMobileActivate").click(function(){ToggleTableEventActivation("1")}),$("#btnMobileHide").click(function(){ToggleTableEventActivation("0")}),$("#btnMobileDelete").click(function(){DeleteTableEvents()}),$("#swipeHoverIcon").on("touchend",function(a){a.preventDefault(),$(".overlayPanelControlElementGroup").children("button").first().is(":visible")?$("#swipeHoverIcon").attr("src","images/SwipeRight.png"):$("#swipeHoverIcon").attr("src","images/SwipeLeft.png"),$(".overlayPanelControlElementGroup").children("button").toggle("slide")}),$("#swipeHoverIcon").click(function(a){a.preventDefault(),$(".overlayPanelControlElementGroup").children("button").first().is(":visible")?$("#swipeHoverIcon").attr("src","images/SwipeRight.png"):$("#swipeHoverIcon").attr("src","images/SwipeLeft.png"),$(".overlayPanelControlElementGroup").children("button").toggle("slide")});var d=$(window).height();lastWindowHeight=d;var e=$(window).width();lastWindowWidth=e;var f=!0;OnViewportSizeChanged(e,d,"desktop",GetCurWidthClass(),"desktop",GetCurHeightClass(),f),$("#evtStatusCreated").prop("checked",!0),$("#evtStatusJoined,#evtStatusCreated").change(function(){var a=$("#evtStatusJoined").is(":checked"),b=$("#evtStatusCreated").is(":checked");a||b||$(this).prop("checked",!0)}),$("#searchPanel .overlayPanelToggleActiveChk").each(function(){$(this).change(function(){var a="#"+$(this).attr("linkId"),b="#"+$(this).attr("groupId"),c="#"+$(this).attr("lblId");if($(a).hasClass("overlayPanelToggleElementInactive")){$(a).removeClass("overlayPanelToggleElementInactive").addClass("overlayPanelToggleElementActive"),$(b).find(".overlayPanelElement").removeClass("filterFieldActive").addClass("filterFieldActive");var d="Deactivate Filter";isMobileView()&&(d="Deactivate"),$(c).text(d)}else{$(a).removeClass("overlayPanelToggleElementActive").addClass("overlayPanelToggleElementInactive"),$(b).find(".overlayPanelElement").removeClass("filterFieldActive");var d="Activate Filter";isMobileView()&&(d="Activate"),$(c).text(d)}})}),$("#searchBtn").click(function(){var a=activePanel===panelEnum.CurrentEventFeed,b=".searchPanelCurEvtsFilter";a||(b=".searchPanelEvtMgrFilter");var c=ValidateSearchFormFields(b,!1);return c.validated&&(a?ReloadCurrentEventsTable(!0):ReloadUserHostedEventsTable(!0)),!1})}function CloseSearchPanel(){return $("#modalOverlay").slideReveal("hide"),$("#searchPanel").slideReveal("hide"),!1}function HandleWidthTransition(a,b,c,d){var e=!1,f=Math.round(.65*a);a>1e3&&(f=Math.round(.45*a)),"desktop"!=b&&!d||"mobile"!=c&&"xtraSmall"!=c||($("#"+gamerTagViewerDlg).length&&$("#"+gamerTagViewerDlg+" .jtable").length&&($(gamerTagViewerJTableDiv+" .jtable-page-size-change").hide(),$("#"+gamerTagViewerDlg).dialog("option","width",400>a?a-25:400)),f="mobile"==c?Math.round(.8*a):Math.round(.95*a),$("#gameFilterStartTime").timepicker("option",{selectOnBlur:!1,useSelect:!0}),$("#gameFilterEndTime").timepicker("option",{selectOnBlur:!1,useSelect:!0}),$("#gameFilterStartDate").prop("readonly",!0),$("#gameFilterEndDate").prop("readonly",!0),$(".overlayPanelToggleActiveLbl").filter(function(a){return"Activate Filter"===$(this).text()}).text("Activate"),$(".overlayPanelToggleActiveLbl").filter(function(a){return"Deactivate Filter"===$(this).text()}).text("Deactivate"),$(".dashboardTitle").show(),$(".mobileButtonToolbarContainer").show(),d||(FormatCurrentEventsTableForCurrentView(!0,c),FormatEventManagerTableForCurrentView(!0,c)),e=!0),"mobile"!=b&&"xtraSmall"!=b&&!d||"desktop"!=c||($("#"+gamerTagViewerDlg).length&&$("#"+gamerTagViewerDlg+" .jtable").length&&($(gamerTagViewerJTableDiv+" .jtable-page-size-change").show(),$("#"+gamerTagViewerDlg).dialog("option","width",600>a?a-25:600)),$("#gameFilterStartTime").timepicker("option",{selectOnBlur:!0,useSelect:!1}),$("#gameFilterEndTime").timepicker("option",{selectOnBlur:!0,useSelect:!1}),$("#gameFilterStartDate").prop("readonly",!1),$("#gameFilterEndDate").prop("readonly",!1),$(".overlayPanelToggleActiveLbl").filter(function(a){return"Activate"===$(this).text()}).text("Activate Filter"),$(".overlayPanelToggleActiveLbl").filter(function(a){return"Deactivate"===$(this).text()}).text("Deactivate Filter"),$(".dashboardTitle").hide(),$(".mobileButtonToolbarContainer").hide(),d||(FormatCurrentEventsTableForCurrentView(!1),FormatEventManagerTableForCurrentView(!1)),e=!0),(Math.abs(a-lastWindowWidth)>50||d)&&(CloseSearchPanel(),$("#modalOverlay").slideReveal({changeWidth:!0,width:a+20}),e&&$("#searchPanel").slideReveal({changeWidth:!0,width:f})),lastWindowWidth=a}function HandleHeightTransition(a,b,c){var d=.9;"desktop"!=c&&(d=.7);var e=d*a;$(".overlayPanelFixedHeightScrollableContainer").css("height",e.toString()+"px"),Math.abs(a-lastWindowHeight)>100&&CloseSearchPanel(),lastWindowHeight=a}function OnViewportSizeChanged(a,b,c,d,e,f,g){HandleWidthTransition(a,c,d,g),HandleHeightTransition(b,e,f),"desktop"==d&&"desktop"==f?($(".overlayPanelFixedHeightScrollableContainer").css("padding-top","2%"),$(".overlayPanelControlElementGroup").children("button").show(),$(".swipeHoverIconContainer").hide()):($(".overlayPanelFixedHeightScrollableContainer").css("padding-top","8%"),$(".swipeHoverIconContainer").show())}function LoadEventManager(){$(eventManagerJTableDiv).jtable({title:"Your Events",paging:!0,pageSize:10,pageSizes:[5,10,15,20,25],pageSizeChangeArea:!0,pageList:"minimal",sorting:!0,defaultSorting:"DisplayDate ASC",openChildAsAccordion:!1,selecting:!0,multiselect:!0,selectingCheckboxes:!0,selectOnRowClick:!1,toolbar:{items:[{text:"Refresh",icon:"images/refresh.png",tooltip:"Refreshes your event list",click:function(){var a=!1;ReloadUserHostedEventsTable(a)}},{text:"Create",icon:"images/calendar.png",tooltip:"Create a new event",click:function(){DisplayCreateEventDialog()}},{text:"Activate Selected",icon:"images/activate.png",tooltip:"Makes selected events active & visible",click:function(){ToggleTableEventActivation("1")}},{text:"Hide Selected",icon:"images/deactivate.png",tooltip:"Makes selected events inactive & invisible",click:function(){ToggleTableEventActivation("0")}},{text:"Leave Selected",icon:"images/cancelsignup.png",tooltip:"Cancels enrollment for selected events",click:function(){LeaveSelectedEvents()}},{text:"Delete Selected",icon:"images/delete.png",tooltip:"Permanently deletes selected events",click:function(){DeleteTableEvents()}}]},actions:{listAction:"AJAXHandler.php"},fields:{ID:{key:!0,list:!1},GameTitle:{title:"Game",width:"11%",sorting:!0},Platform:{title:"Console",width:"11%",sorting:!0},DisplayDate:{title:"Date",width:"14%",sorting:!0,display:function(a){var b=moment.utc(a.record.EventScheduledForDate,"YYYY-MM-DD HH:mm:ss"),c=b.local(),d=c.format("MMM D, YYYY"),e=$('<label title="Date in Time Zone where Event Created: '+a.record.DisplayDate+'">'+d+"</label>");return e}},DisplayTime:{title:"Time",width:"12%",sorting:!1,display:function(a){var b=moment.utc(a.record.EventScheduledForDate,"YYYY-MM-DD HH:mm:ss"),c=b.local(),d=c.format("h:mma"),e=$('<label title="Time in Time Zone where Event Created: '+a.record.DisplayTime+'">'+d+"</label>");return e}},Notes:{title:"Game Notes",width:"21%",sorting:!1},PlayersSignedUp:{title:"Players Joined",width:"10%",display:function(a){var b=a.record.ID,c=$("<label>"+a.record.PlayersSignedUp+'&nbsp;&nbsp;<label id="lblEvt'+b+'" class="fa fa-plus-square" /></label>');return c.click(function(){var a=$(this).closest("tr"),c="#lblEvt"+b;return $(eventManagerJTableDiv).jtable("isChildRowOpen",a,!0)?($(eventManagerJTableDiv).jtable("closeChildTable",a,void 0,!0),void $(c).attr("class","fa fa-plus-square")):void ShowChildTableForJoinedPlayers(a,c,eventManagerJTableDiv)}),c},sorting:!1},Hidden:{title:"Hidden",width:"7%",sorting:!0},EventCreator:{title:"Creator",width:"7%",sorting:!0,display:function(a){if("ME"!==a.record.EventCreator){var b=$('<a href="#" class="actionLink" id="unDetailsLink'+a.record.ID+'">'+a.record.EventCreator+"</a>");return b.click(function(){return OpenUserDetailsPopup(a.record.EventCreatorUserID,a.record.EventCreator),!1}),b}return $("<label>"+a.record.EventCreator+"</label>")}},Actions:{title:"Actions",width:"7%",sorting:!1,columnSelectable:!1,display:function(a){if("EDIT"==a.record.Actions||"LEAVE"==a.record.Actions){var b=$('<a href="#" class="actionLink" id="evtLink'+a.record.ID+'">'+a.record.Actions+"</a>");return"EDIT"===a.record.Actions?(b=$('<img src="images/edit.png" />'),b.click(function(){DisplayEditEventDialog(a.record.ID)})):b.click(function(){var b=[a.record.ID];return LeaveEvents(b),!1}),b}return $("<label>"+a.record.Actions+"</label>")}}},recordsLoaded:function(a,b){$(eventManagerJTableDiv+" .jtable-data-row").each(function(){var a=$(this).attr("data-record-key"),c=$.grep(b.records,function(b){return b.ID===a}),d=c[0].PlayersSignedUpData;$(this).attr("data-playersSignedUp",d);var e=$("#pmx").length>0&&"ME"===c[0].EventCreator;OpenChildTableForJoinedPlayers($(this),eventManagerJTableDiv,e);var f=c[0].Hidden,g=c[0].Actions,h=c[0].EventCreator,i=IsPastEvent(c[0].EventScheduledForDate);"LEAVE"!==g||"ME"===h||i?"ME"===h||"FULL"!==g||i?"ME"!==h||"Yes"===f||i?("Yes"===f||i)&&$(this).css("color","gray"):$(this).css("color","blue"):$(this).css("color","red"):$(this).css("color","green")});var c=GetCurWidthClass();"desktop"!=c&&FormatEventManagerTableForCurrentView(!0,c)}});var a={action:eventManagerLoadAction,"evtStatus[]":"showCreated"};$(eventManagerJTableDiv).jtable("load",a),EventManagerOnReady()}function LoadCurrentEventViewer(){$(currentEventViewerJTableDiv).jtable({title:"Browse Events Hosted By Other Users",paging:!0,pageSize:10,pageSizes:[5,10,15,20,25],pageSizeChangeArea:!0,pageList:"minimal",sorting:!0,defaultSorting:"DisplayDate ASC",openChildAsAccordion:!1,selecting:!0,multiselect:!0,selectingCheckboxes:!0,selectOnRowClick:!1,toolbar:{items:[{text:"Refresh",icon:"images/refresh.png",tooltip:"Refreshes current event list",click:function(){var a=!1;ReloadCurrentEventsTable(a)}},{text:"Join Selected",icon:"images/signup.png",tooltip:"Signs you up for all selected events",click:function(){JoinSelectedEvents()}}]},actions:{listAction:"AJAXHandler.php"},fields:{ID:{key:!0,list:!1},UserName:{title:"User",width:"8%",sorting:!0,display:function(a){var b=$('<a href="#" class="actionLink" id="unDetailsLink'+a.record.ID+'">'+a.record.UserName+"</a>");return b.click(function(){return OpenUserDetailsPopup(a.record.UserID,a.record.UserName),!1}),b}},GameTitle:{title:"Game",width:"15%",sorting:!0},Platform:{title:"Console",width:"11%",sorting:!0},DisplayDate:{title:"Date",width:"14%",sorting:!0,display:function(a){var b=moment.utc(a.record.EventScheduledForDate,"YYYY-MM-DD HH:mm:ss"),c=b.local(),d=c.format("MMM D, YYYY"),e=$('<label title="Date in Event Creator Time Zone: '+a.record.DisplayDate+'">'+d+"</label>");return e}},DisplayTime:{title:"Time",width:"12%",sorting:!1,display:function(a){var b=moment.utc(a.record.EventScheduledForDate,"YYYY-MM-DD HH:mm:ss"),c=b.local(),d=c.format("h:mma"),e=$('<label title="Time in Event Creator Time Zone: '+a.record.DisplayTime+'">'+d+"</label>");return e}},Notes:{title:"Game Notes",width:"22%",sorting:!1},Actions:{title:"Actions",width:"7%",sorting:!0,display:function(a){if("JOIN"==a.record.Actions){var b=$('<a href="#" class="actionLink" id="evtLink'+a.record.ID+'">'+a.record.Actions+"</a>");return b.click(function(){var b=[a.record.ID];return JoinEvents(b),!1}),b}return $("<label>"+a.record.Actions+"</label>")}},PlayersSignedUp:{title:"Players Joined",width:"11%",display:function(a){var b=a.record.ID,c=$("<label>"+a.record.PlayersSignedUp+'&nbsp;&nbsp;<label id="lblCurEvt'+b+'" class="fa fa-plus-square" /></label>');return c.click(function(){var a=$(this).closest("tr"),c="#lblCurEvt"+b;return $(currentEventViewerJTableDiv).jtable("isChildRowOpen",a,!0)?($(currentEventViewerJTableDiv).jtable("closeChildTable",a,void 0,!0),void $(c).attr("class","fa fa-plus-square")):void ShowChildTableForJoinedPlayers(a,c,currentEventViewerJTableDiv)}),c},sorting:!1}},recordsLoaded:function(a,b){if(null!==b.records&&b.records.length>0){var c=b.records[0].TotalGamesToJoinCount,d="need";1==c&&(d="needs"),$("#totalGamesToJoin").text("("+c+") "+d+" joining!")}$(currentEventViewerJTableDiv+" .jtable-data-row").each(function(){var a=$(this).attr("data-record-key"),c=$.grep(b.records,function(b){return b.ID===a}),d=c[0].PlayersSignedUpData;$(this).attr("data-playersSignedUp",d),OpenChildTableForJoinedPlayers($(this),currentEventViewerJTableDiv,!1);var e=c[0].Actions;"FULL"!==e||IsPastEvent(c[0].EventScheduledForDate)?"JOIN"!==e&&$(this).css("color","gray"):$(this).css("color","red")});var e=GetCurWidthClass();"desktop"!=e&&FormatCurrentEventsTableForCurrentView(!0,e)}});var a={action:currentEventViewerLoadAction};$(currentEventViewerJTableDiv).jtable("load",a),CurrentEventViewerOnReady()}function FormatEventManagerTableForCurrentView(a,b){var c="evtMgrHiddenInMobileView";if(a){$("."+c).removeClass(c),$(eventManagerJTableDiv+" .fixedWidthScrollableContainer .jtable").unwrap();var d=["Game","Console"],e={Game:!1,Console:!0};CombineTableColumns(d,e,eventManagerJTableDiv,c),d=["Date","Time"],e={Date:!1,Time:!1},CombineTableColumns(d,e,eventManagerJTableDiv,c),$(eventManagerJTableDiv+" .jtable-title-text").text("YOUR EVENTS"),$(eventManagerJTableDiv+" .jtable-toolbar-item").hide();var f=$(eventManagerJTableDiv+' th:contains("Game Notes")'),g=$(eventManagerJTableDiv+' th:contains("Hidden")'),h=$(f).index(),i=$(g).index();if($(f).addClass(c),$(g).addClass(c),$(eventManagerJTableDiv).children(".jtable-main-container").children(".jtable").children("tbody").children("tr").each(function(){var a=$(this).children("td").eq(h),b=$(this).children("td").eq(i);$(a).addClass(c),$(b).addClass(c)}),$(eventManagerJTableDiv+" .jtable-page-size-change").hide(),"xtraSmall"==b&&$(eventManagerJTableDiv+" .jtable-goto-page").hide(),$(eventManagerJTableDiv+" table").removeClass("desktopViewFontSize").addClass("mobileViewFontSize"),$(eventManagerJTableDiv+" .jtable-main-container").children(".jtable").wrap('<div class="fixedWidthScrollableContainer"></div>'),$(eventManagerJTableDiv+" .jtable-title").is(":visible")){var j=$(eventManagerJTableDiv+" .jtable-title").width();$(eventManagerJTableDiv+" .fixedWidthScrollableContainer").css("width",j+10+"px")}}else{var k=["Console"];ExpandTableColumn("Game",k,eventManagerJTableDiv,c),k=["Time"],ExpandTableColumn("Date",k,eventManagerJTableDiv,c),$(eventManagerJTableDiv+" .jtable-title-text").text("Your Events"),$(eventManagerJTableDiv+" .jtable-toolbar-item").show(),$("."+c).removeClass(c),$(eventManagerJTableDiv+" .jtable-page-size-change").show(),$(eventManagerJTableDiv+" .jtable-goto-page").show(),$(eventManagerJTableDiv+" table").removeClass("mobileViewFontSize").addClass("desktopViewFontSize"),$(eventManagerJTableDiv+" .fixedWidthScrollableContainer .jtable").unwrap()}}function FormatCurrentEventsTableForCurrentView(a,b){var c="curEvtsHiddenInMobileView";if(a){$("."+c).removeClass(c),$(currentEventViewerJTableDiv+" .fixedWidthScrollableContainer .jtable").unwrap();var d=["Game","Console"],e={Game:!1,Console:!0};CombineTableColumns(d,e,currentEventViewerJTableDiv,c),d=["Date","Time"],e={Date:!1,Time:!1},CombineTableColumns(d,e,currentEventViewerJTableDiv,c),"mobile"==b?$(currentEventViewerJTableDiv+" .jtable-title-text").text("BROWSE USER EVENTS"):"xtraSmall"==b&&$(currentEventViewerJTableDiv+" .jtable-title-text").text("EVENT LIST"),$(currentEventViewerJTableDiv+' .jtable-toolbar-item-text:contains("Join Selected")').text("Join");var f=$(currentEventViewerJTableDiv+' th:contains("Game Notes")'),g=$(currentEventViewerJTableDiv+" th").filter(function(){return"Actions"===$(this).text()}).eq(0),h=$(f).index(),i=$(g).index();if($(f).addClass(c),$(g).addClass(c),$(currentEventViewerJTableDiv).children(".jtable-main-container").children(".jtable").children("tbody").children("tr").each(function(){var a=$(this).children("td").eq(h),b=$(this).children("td").eq(i);$(a).addClass(c),$(b).addClass(c)}),$(currentEventViewerJTableDiv+" .jtable-page-size-change").hide(),"xtraSmall"==b&&$(currentEventViewerJTableDiv+" .jtable-goto-page").hide(),$(currentEventViewerJTableDiv+" table").removeClass("desktopViewFontSize").addClass("mobileViewFontSize"),$(currentEventViewerJTableDiv+" .jtable-main-container").children(".jtable").wrap('<div class="fixedWidthScrollableContainer"></div>'),$(currentEventViewerJTableDiv+" .jtable-title").is(":visible")){var j=$(currentEventViewerJTableDiv+" .jtable-title").width();$(currentEventViewerJTableDiv+" .fixedWidthScrollableContainer").css("width",j+10+"px")}}else{var k=["Console"];ExpandTableColumn("Game",k,currentEventViewerJTableDiv,c),k=["Time"],ExpandTableColumn("Date",k,currentEventViewerJTableDiv,c),$(currentEventViewerJTableDiv+" .jtable-title-text").text("Browse Events Hosted By Other Users"),$(currentEventViewerJTableDiv+' .jtable-toolbar-item-text:contains("Join")').text("Join Selected"),$("."+c).removeClass(c),$(currentEventViewerJTableDiv+" .jtable-page-size-change").show(),$(currentEventViewerJTableDiv+" .jtable-goto-page").show(),$(currentEventViewerJTableDiv+" table").removeClass("mobileViewFontSize").addClass("desktopViewFontSize"),$(currentEventViewerJTableDiv+" .fixedWidthScrollableContainer .jtable").unwrap()}}function ToggleSearchDivDisplay(a,b){var c=$(b).hasClass("fa-plus-square");return c?($(a).removeClass("overlayPanelGroupBorder").addClass("overlayPanelGroupBorder"),$(a).removeClass("overlayPanelGroupExpanded").addClass("overlayPanelGroupExpanded"),$(a).slideDown("slow"),$(b).removeClass("fa-plus-square").addClass("fa-minus-square")):($(a).removeClass("overlayPanelGroupBorder"),$(a).removeClass("overlayPanelGroupExpanded"),$(a).slideUp("slow"),$(b).removeClass("fa-minus-square").addClass("fa-plus-square")),!1}function CurrentEventViewerOnReady(){}function EventManagerOnReady(){}function IsPastEvent(a){var b=moment().utc(),c=moment(a+" +0000","YYYY-MM-DD HH:mm:ss Z");return c.isBefore(b)?!0:!1}function DeselectAllJTableRows(a){$(a).find(".jtable-row-selected").each(function(){$(this).removeClass("jtable-row-selected")}),$(a).find(".jtable-selecting-column > input").each(function(){$(this).prop("checked",!1)}),$(a).find(".jtable-command-column-header.jtable-column-header-selecting > input").each(function(){$(this).prop("checked",!1)})}function DeselectJTableRowsByKey(a,b){for(var c=0;c<b.length;c++){var d=b[c];$(a).find(".jtable-row-selected[data-record-key='"+d+"']").each(function(){$(this).removeClass("jtable-row-selected"),$(this).find(".jtable-selecting-column > input").each(function(){$(this).prop("checked",!1)})})}}function ToggleTableEventActivation(a){var b=$(eventManagerJTableDiv).jtable("selectedRows");if(0===b.length)return void sweetAlert("No events selected");var c=[],d=[];b.each(function(){var a=$(this).data("record").ID,b=$(this).data("record").EventCreator;"ME"===b?c.push(a):d.push(a)}),0===c.length?(sweetAlert("ERROR","No selected events may be edited: you can only change event status for events you own","error"),DeselectJTableRowsByKey(eventManagerJTableDiv,d)):ToggleEventVisibility(c,a)||DeselectAllJTableRows(eventManagerJTableDiv)}function DeleteTableEvents(){var a=$(eventManagerJTableDiv).jtable("selectedRows");if(0===a.length)return void sweetAlert("No events selected");var b=[],c=[];a.each(function(){var a=$(this).data("record").ID,d=$(this).data("record").EventCreator;"ME"===d?b.push(a):c.push(a)}),0===b.length?(sweetAlert("ERROR","No selected events may be deleted: you can only delete events you have created","error"),DeselectJTableRowsByKey(eventManagerJTableDiv,c)):DeleteEvents(b)||DeselectAllJTableRows(eventManagerJTableDiv)}function JoinSelectedEvents(){var a=$(currentEventViewerJTableDiv).jtable("selectedRows");if(0===a.length)return void sweetAlert("No events selected");var b=[],c=[];a.each(function(){var a=$(this).data("record").ID,d=$(this).data("record").Joined;"JOIN"===d?b.push(a):c.push(a)}),0===b.length?(sweetAlert("No selected events may be joined: you can only join future events which are not full, and which you haven't already joined"),DeselectJTableRowsByKey(currentEventViewerJTableDiv,c)):JoinEvents(b)||DeselectJTableRowsByKey(currentEventViewerJTableDiv,c)}function LeaveSelectedEvents(){var a=$(eventManagerJTableDiv).jtable("selectedRows");if(0===a.length)return void sweetAlert("No events selected");var b=[],c=[];a.each(function(){var a=$(this).data("record").ID,d=$(this).data("record").Actions;"LEAVE"===d?b.push(a):c.push(a)}),0===b.length?(sweetAlert("No selected events may be left: you can only leave events scheduled for the future, and which you have already joined"),DeselectJTableRowsByKey(eventManagerJTableDiv,c)):LeaveEvents(b)||DeselectJTableRowsByKey(eventManagerJTableDiv,c)}function OpenChildTableForJoinedPlayers(a,b,c){$(b).jtable("openChildTable",a,{title:"",childTableNoReloadOnOpen:!0,actions:{listAction:function(){return GetChildDataForRow(a)}},fields:{ID:{key:!0,list:!1},PlayerName:{title:"Player Name",width:"50%",sorting:!0,display:function(a){var b=$('<a href="#" class="actionLink" id="unDetailsLink'+a.record.ID+'">'+a.record.PlayerName+"</a>");return b.click(function(){return OpenUserDetailsPopup(a.record.UserID,a.record.PlayerName),!1}),b}},GamerTags:{title:"View Gamer Tags",width:"25%",sorting:!1,display:function(a){var b=$('<a href="#" class="actionLink" id="tagsLink'+a.record.ID+'">Show Tags</a>');return b.click(function(){return OpenGamerTagViewer(gamerTagViewerDlg,gamerTagViewerJTableDiv.substring(1),"Gamer Tag Viewer","Gamer Tags For: "+a.record.PlayerName,!0,!0,a.record.UserID),!1}),b}},RemovePlayer:{title:"Remove Member",width:"25%",sorting:!1,columnSelectable:!1,display:function(a){var b=$('<img alt="Remove" id="rem'+a.record.ID+'" title="Remove this player from event" src="images/cancelsignup.png" />');return b.click(function(){return RemovePlayerFromEvent(a.record.ID),!1}),-1==a.record.PlayerName.indexOf("(Creator)")?b:$("<label />")}}},recordsLoaded:function(){if($(this).find("table.jtable > tbody > tr").each(function(){$(this).addClass("customTheme")}),$(this).find("table.jtable").each(function(){$(this).addClass("jTableChild")}),!c){var a=$(this).find('table.jtable > thead > tr > th:contains("Remove Member")'),b=$(a).index();$(a).addClass("hidden"),$(this).find("table.jtable > tbody > tr").each(function(){var a=$(this).children("td").eq(b);$(a).addClass("hidden")})}}},function(a){a.childTable.jtable("load",{})})}function ShowChildTableForJoinedPlayers(a,b,c){a.siblings(c+" .jtable-data-row").each(function(){$(c).jtable("closeChildTable",$(this),void 0,!0)}),$(c+" .fa.fa-minus-square").each(function(){$(this).attr("class","fa fa-plus-square")}),$(c).jtable("showChildTable",a),$(b).attr("class","fa fa-minus-square")}function GetChildDataForRow(a){for(var b=a.attr("data-playersSignedUp"),c=b.split(","),d=c.length,e=[],f=0;f<c.length;f++){var g=c[f].split("|");e.push({ID:g[0],PlayerName:g[1],UserID:g[2]})}return{Result:"OK",Records:e,TotalRecordCount:d}}function ReloadGameTitleSelector(a){var b="";a>-1&&(b=a.toString()),$.ajax({type:"POST",url:"AJAXHandler.php",data:"action=ReloadGameTitleSelector",success:function(a){$("#gameSelectorDiv"+b).html(a),PrepareAutocompleteComboBox("selGameTitle"+b),$("#ddlGameTitles"+b).combobox()},error:function(){var a='<select id="ddlGameTitles'+b+'" name="ddlGameTitles'+b+'"><option value="-1" class="globalGameOption">Unable to reload game title selector...please try again later</option></select>';$("#gameSelectorDiv"+b).html(a)}})}function ToggleEventVisibility(a,b){var c="all selected events";1===a.length&&(c="this event");var d="Are you sure you want to hide "+c+"?";"1"===b&&(d="Are you sure you want to make "+c+" visible?"),sweetAlert({title:"Confirm Event Change",text:d,type:"warning",showCancelButton:!0,confirmButtonText:"Yes, do it!",closeOnConfirm:!1,closeOnCancel:!1,showLoaderOnConfirm:!0},function(c){if(c){for(var d=[],e=0;e<a.length;e++)d.push({name:"eventIds[]",value:a[e].toString()});$.ajax({type:"POST",url:"AJAXHandler.php",data:"action=EventEditorToggleEventVisibility&"+$.param({eventIds:a})+"&isActive="+b,success:function(a){var b=!1;ReloadUserHostedEventsTable(b),a.match("^SYSTEM ERROR")?sweetAlert("Events Not Changed",a,"error"):sweetAlert("Events Changed!",a,"success")},error:function(){sweetAlert("Events Not Changed","Unable to change visibility for selected events: server error. Please try again later.","error")}})}else sweetAlert("Event Change Canceled","Your events' visibility has not been changed","info")})}function DeleteEvents(a){sweetAlert({title:"Confirm Delete",text:"Are you sure you want to delete all selected events?",type:"warning",showCancelButton:!0,confirmButtonText:"Yes, do it!",closeOnConfirm:!1,closeOnCancel:!1,showLoaderOnConfirm:!0},function(b){b?$.ajax({type:"POST",url:"AJAXHandler.php",data:"action=EventEditorDeleteEvents&"+$.param({eventIds:a}),success:function(a){var b=!1;ReloadUserHostedEventsTable(b),a.match("^SYSTEM ERROR")?sweetAlert("Events Not Deleted",a,"error"):sweetAlert("Events Deleted!",a,"success")},error:function(){sweetAlert("Events Not Deleted","Unable to delete events: server error. Please try again later.","error")}}):sweetAlert("Events Deletion Canceled","Your events have not been deleted","info")})}function JoinEvents(a){sweetAlert({title:"Confirm Join",text:"Join this Event?",type:"warning",showCancelButton:!0,confirmButtonText:"You Bet!",closeOnConfirm:!1,closeOnCancel:!1,showLoaderOnConfirm:!0},function(b){b?$.ajax({type:"POST",url:"AJAXHandler.php",data:"action=EventViewerJoinEvents&"+$.param({eventIds:a}),success:function(a){var b=!1;ReloadCurrentEventsTable(b),ReloadUserHostedEventsTable(b),a.match("^SYSTEM ERROR")?sweetAlert("Events Not Joined",a,"error"):sweetAlert("Events Joined!",a,"success")},error:function(){sweetAlert("Events Not Joined","Unable to join events: server error. Please try again later.","error")}}):sweetAlert("Events Not Joined","Canceled join events","info")})}function LeaveEvents(a){sweetAlert({title:"Confirm Leave",text:"Leave this Event?",type:"warning",showCancelButton:!0,confirmButtonText:"Yep, I want out!",closeOnConfirm:!1,closeOnCancel:!1,showLoaderOnConfirm:!0},function(b){b?$.ajax({type:"POST",url:"AJAXHandler.php",data:"action=EventViewerLeaveEvents&"+$.param({eventIds:a}),success:function(a){var b=!1;ReloadCurrentEventsTable(b),ReloadUserHostedEventsTable(b),a.match("^SYSTEM ERROR")?sweetAlert("Events Not Left",a,"error"):sweetAlert("Events Left!",a,"success")},error:function(){sweetAlert("Events Not Left","Unable to leave events: server error. Please try again later.","error")}}):sweetAlert("Events Not Left","Canceled leave events","info")})}function ReloadUserHostedEventsTable(a){if(a){var b=ValidateSearchFormFields(".searchPanelEvtMgrFilter",!0),c="action="+eventManagerLoadAction+b.postData;$(eventManagerJTableDiv).jtable("load",c)}else $(eventManagerJTableDiv).jtable("reload")}function ReloadCurrentEventsTable(a){if(a){var b=ValidateSearchFormFields(".searchPanelCurEvtsFilter",!0),c="action="+currentEventViewerLoadAction+b.postData;$(currentEventViewerJTableDiv).jtable("load",c)}else $(currentEventViewerJTableDiv).jtable("reload")}function DisplayCreateEventDialog(){var a=GetCurWidthClass(),b=GetCurHeightClass(),c="top",d=600,e=700;"mobile"==a&&(d=400,c="top+10%"),"xtraSmall"==a&&(d=275,c="top+10%"),("mobile"==b||"xtraSmall"==b)&&(e=450),displayJQueryDialog("dlgCreateEvt","Create Event","top",c,window,!1,!0,"AJAXHandler.php?action=EventEditorLoad",function(){var b=-1;EventSchedulerDialogOnReady(b,$("#dlgCreateEvt").dialog(),a)},d,e)}function DisplayEditEventDialog(a){var b=GetCurWidthClass(),c=GetCurHeightClass(),d="top",e=600,f=700;"mobile"==b&&(e=400,d="top+10%"),"xtraSmall"==b&&(e=275,d="top+10%"),("mobile"==c||"xtraSmall"==c)&&(f=450),displayJQueryDialog("dlgEditEvent"+a,"Edit Event","top",d,window,!1,!0,"AJAXHandler.php?action=EventEditorLoad&EventID="+a,function(){EventSchedulerDialogOnReady(a,$("#dlgEditEvent"+a).dialog(),b)},e,f)}function EventSchedulerDialogOnReady(a,b,c){var d="",e="";if(a>-1){d=a.toString(),$("#editEventBtn"+d).click(function(){return EditEvent(d,b)});var f="#toggleEventVisibilityBtn"+d;$(f).click(function(){var c=$(f).attr("myAction"),d=[a];return ToggleEventVisibility(d,c),b.dialog("destroy").remove(),!1}),$("#deleteEventBtn"+d).click(function(){var c=[a];return DeleteEvents(c),b.dialog("destroy").remove(),!1}),PrepareAutocompleteComboBox("selGameTitle"+d),$("#ddlGameTitles"+d).combobox();var g=$("#selGameTitle"+d).val(),h=$("#gameDate"+d).val();e=$("#gameTime"+d).val();var i='Editing Event: "'+g+'" @ '+h+" "+e;b.dialog("option","title",i)}else PrepareAutocompleteComboBox("selGameTitle"),$("#ddlGameTitles").combobox(),$("#createEventBtn").click(function(){return CreateEvent(b)});$("#cancelEventBtn"+d).click(function(){return b.dialog("destroy").remove(),!1}),$("#gameDate"+d).datepicker({inline:!0,yearRange:"-0:+1",changeYear:!0,changeMonth:!0,constrainInput:!0,showButtonPanel:!0,showOtherMonths:!0,dayNamesMin:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dateFormat:"yy-mm-dd"});var j=null;if(0===e.length){var k=new Date,l=15-k.getMinutes()%15;k.setMinutes(k.getMinutes()+l),j=k}else j=e;var m=isMobileView(),n={disableTextInput:!1,disableTouchKeyboard:!1,minTime:j,selectOnBlur:!m,useSelect:m,step:15};$("#gameTime"+d).timepicker(n),$("#privateEvent"+d).click(function(){var a=this.checked;a?($("input[name='pvtEventFriends"+d+"[]']").removeProp("disabled"),$("#selectAllFriends"+d).removeProp("disabled")):($("input[name='pvtEventFriends"+d+"[]']").prop("disabled",!0),$("input[name='pvtEventFriends"+d+"[]']").prop("checked",!1),$("#selectAllFriends"+d).prop("disabled",!0),$("#selectAllFriends"+d).prop("checked",!1))}),"xtraSmall"==c&&$("#selectAllFriends"+d).removeClass("selectAllCheckbox").addClass("xtraSmallSelectAllCheckbox"),$("#selectAllFriends"+d).click(function(){
var a=this.checked;a?$("input[name='pvtEventFriends"+d+"[]']").prop("checked",!0):$("input[name='pvtEventFriends"+d+"[]']").prop("checked",!1)})}function ToggleControlPanelDisplay(a){if("none"===$(a).css("display"))if($(activePanel).hide(),activePanel=a,$(a).fadeIn("slow",function(){}),activePanel==panelEnum.CurrentEventFeed){var b=$(currentEventViewerJTableDiv+" .jtable-title").width();$(currentEventViewerJTableDiv+" .fixedWidthScrollableContainer").css("width",b+10+"px")}else{var b=$(eventManagerJTableDiv+" .jtable-title").width();$(eventManagerJTableDiv+" .fixedWidthScrollableContainer").css("width",b+10+"px")}return CloseSearchPanel(),DisplaySearchFiltersByCurrentView(),!1}function DisplaySearchFiltersByCurrentView(){var a=$("#searchPanel .overlayPanelToggleGroup.searchPanelEvtMgrFilter,#searchPanel .overlayPanelToggleGroup.searchPanelCurEvtsFilter"),b=a.not(".searchPanelCurEvtsFilter"),c=a.not(".searchPanelEvtMgrFilter");a=$("#searchPanel .overlayPanelFilterSubGroup .searchPanelEvtMgrFilter,#searchPanel .overlayPanelFilterSubGroup .searchPanelCurEvtsFilter");var d=a.not(".searchPanelCurEvtsFilter"),e=a.not(".searchPanelEvtMgrFilter");if(activePanel===panelEnum.CurrentEventFeed){$("#searchPanel").removeClass("overlayPanelGreenBackground").addClass("overlayPanelOrangeBackground"),expandedEvtMgrFilterGroups=[],$("#searchPanel .overlayPanelFilterGroup.searchPanelEvtMgrFilter.overlayPanelGroupExpanded").not(".searchPanelCurEvtsFilter").each(function(){expandedEvtMgrFilterGroups.push($(this).attr("id")),$(this).removeClass("overlayPanelGroupBorder"),$(this).removeClass("overlayPanelGroupExpanded"),$(this).slideUp("slow")}),b.hide(),c.show(),d.hide(),e.show();var f;for(f=0;f<expandedCurEventsFilterGroups.length;f++){var g=$("#"+expandedCurEventsFilterGroups[f]);g.removeClass("overlayPanelGroupBorder").addClass("overlayPanelGroupBorder"),g.removeClass("overlayPanelGroupExpanded").addClass("overlayPanelGroupExpanded"),g.slideDown("slow")}}else{$("#searchPanel").removeClass("overlayPanelOrangeBackground").addClass("overlayPanelGreenBackground"),expandedCurEventsFilterGroups=[],$("#searchPanel .overlayPanelFilterGroup.searchPanelCurEvtsFilter.overlayPanelGroupExpanded").not(".searchPanelEvtMgrFilter").each(function(){expandedCurEventsFilterGroups.push($(this).attr("id")),$(this).removeClass("overlayPanelGroupBorder"),$(this).removeClass("overlayPanelGroupExpanded"),$(this).slideUp("slow")}),c.hide(),b.show(),e.hide(),d.show();var f;for(f=0;f<expandedEvtMgrFilterGroups.length;f++){var g=$("#"+expandedEvtMgrFilterGroups[f]);g.removeClass("overlayPanelGroupBorder").addClass("overlayPanelGroupBorder"),g.removeClass("overlayPanelGroupExpanded").addClass("overlayPanelGroupExpanded"),g.slideDown("slow")}}}function ValidateEventFormFields(a){var b="create",c="";a>-1&&(b="update",c=a.toString());var d=$("#gamePlayersNeeded"+c).val(),e=$("input[name='pvtEventFriends"+c+"[]']:checked").length,f=$("#privateEvent"+c).is(":checked"),g=$("#gameDate"+c).val(),h=$("#gameTime"+c).val(),i=$("#ddlTimeZones"+c+" option:selected").text(),j=g+" "+h+" "+i,k=$("#message"+c).val(),l="globalGameOption"==$("#ddlGameTitles"+c+" option:selected").attr("class")?"true":"false",m=null!=$("#ddlGameTitles"+c).val()&&$("#ddlGameTitles"+c).val().length>0,n=moment().utc(),o=new EventFormInfo(j,k,l,m,n,$("#selGameTitle"+c).val()),p=/^\d{1,2}:\d{2}([apAP][mM])?$/;if(0===g.length)sweetAlert("Oops...","Unable to "+b+" event: Please select a date","error");else if(0===h.length)sweetAlert("Oops...","Unable to "+b+" event: Please select a time","error");else if(h.match(p))if(0===k.trim().length)sweetAlert("Oops...","Unable to "+b+" event: Please enter notes about your event","error");else if(f&&d>e+1)sweetAlert("Oops...","Unable to "+b+" event: New set of allowed friends is smaller than the number of members required for this event","error");else{var q=moment.tz(g+" "+h,"YYYY-MM-DD h:mmA",i),r=moment(q).utc();o.gameTimeMoment=r,r.isBefore(n)?sweetAlert("Oops...","Unable to "+b+" event: Scheduled game time '"+j+"' is in the past","error"):o.validated=!0}else sweetAlert("Oops...","Unable to "+b+" event: Please enter a valid time","error");return o}function ValidateSearchFormFields(a,b){var c=new SearchEventsFormInfo,d=!0;if($("#dateRangeFilterLink").length&&$("#dateRangeFilterLink").hasClass("overlayPanelToggleElementActive")){d=!1;var e=$("#gameFilterStartDate").val(),f=$("#gameFilterStartTime").val(),g=$("#ddlTimeZonesStart option:selected").text(),h=$("#gameFilterEndDate").val(),i=$("#gameFilterEndTime").val(),j=$("#ddlTimeZonesEnd option:selected").text(),k=/^\d{1,2}:\d{2}([apAP][mM])?$/;if(0===e.length)b||sweetAlert("Unable to filter by date range: Must select a start date");else if(0===f.length)b||sweetAlert("Unable to filter by date range: Must select a start time");else if(f.match(k))if(0===h.length)b||sweetAlert("Unable to filter by date range: Must select a end date");else if(0===i.length)b||sweetAlert("Unable to filter by date range: Must select a end time");else if(i.match(k)){var l=moment.tz(e+" "+f,"YYYY-MM-DD h:mmA",g),m=moment(l).utc(),n=moment.tz(h+" "+i,"YYYY-MM-DD h:mmA",j),o=moment(n).utc();c.gameStartDateTimeMoment=m,c.gameEndDateTimeMoment=o,c.postData+="&gameFilterStartDateTime="+m.toISOString()+"&gameFilterEndDateTime="+o.toISOString(),d=!0}else b||sweetAlert("Unable to filter by date range: Must enter a valid end time");else b||sweetAlert("Unable to filter by date range: Must enter a valid start time")}var p=$(a).find("*[name]").filter(".filterFieldActive");return p&&p.length&&(c.postData+="&"+p.serialize()),c.validated=d,c}function EventFormInfo(a,b,c,d,e,f){this.displayDatetime=a,this.comments=b,this.isGlobalGame=c,this.isExistingGame=d,this.gameTimeMoment=e,this.selGameTitle=f,this.validated=!1}function SearchEventsFormInfo(){this.gameStartDateTimeMoment="",this.gameEndDateTimeMoment="",this.validated=!1,this.postData=""}function RemovePlayerFromEvent(a){sweetAlert({title:"Confirm Removal",text:"Remove this player?",type:"warning",showCancelButton:!0,confirmButtonText:"Yep, boot them out!",closeOnConfirm:!1,closeOnCancel:!1,showLoaderOnConfirm:!0},function(b){b?$.ajax({type:"POST",url:"AJAXHandler.php",data:"action=EventViewerRemoveMemberFromEvent&evtMember="+a,success:function(a){var b=!1;ReloadUserHostedEventsTable(b),a.match("^SYSTEM ERROR")?sweetAlert("Player Not Removed",a,"error"):sweetAlert("Player Removed",a,"success")},error:function(){sweetAlert("Player Not Removed","Unable to remove player form event: server error. Please try again later.","error")}}):sweetAlert("Player Not Removed","Canceled event member removal","info")})}function EditEvent(a,b){var c=ValidateEventFormFields(a);if(c.validated){var d="action=EventEditorUpdateEvent&isGlobalGame="+c.isGlobalGame+"&gameTitle="+c.selGameTitle+"&eventId="+a+"&gameDateUTC="+c.gameTimeMoment.toISOString()+"&"+$("#eventEditForm"+a).serialize();$.ajax({type:"POST",url:"AJAXHandler.php",data:d,success:function(d){if("true"===d){var e=!1;ReloadUserHostedEventsTable(e),c.isExistingGame||ReloadGameTitleSelector(a),sweetAlert("Success",'Updated event for game "'+c.selGameTitle+'" at '+c.displayDatetime+"!","success"),b.dialog("destroy").remove()}else sweetAlert(d)}})}return!1}function CreateEvent(a){var b=-1,c=ValidateEventFormFields(b);if(c.validated){var d="action=EventEditorCreateEvent&isGlobalGame="+c.isGlobalGame+"&gameTitle="+c.selGameTitle+"&gameDateUTC="+c.gameTimeMoment.toISOString()+"&"+$("#eventCreateForm").serialize();$.ajax({type:"POST",url:"AJAXHandler.php",data:d,success:function(d){if("true"===d){var e=!1;ReloadUserHostedEventsTable(e),c.isExistingGame||ReloadGameTitleSelector(b),sweetAlert("Success",'Created event for game "'+c.selGameTitle+'" at '+c.displayDatetime+"!","success"),a.dialog("destroy").remove()}else sweetAlert(d)}})}return!1}var panelEnum={MyEventViewer:"#manageEventsDiv",CurrentEventFeed:"#currentEventsDiv"},activePanel=panelEnum.CurrentEventFeed,eventManagerLoadAction="GetUserOwnedEventsForJTable",eventManagerJTableDiv="#manageEventsContent",currentEventViewerJTableDiv="#currentEventsContent",currentEventViewerLoadAction="GetCurrentEventsForJTable",gamerTagViewerDlg="gamerTagViewerDlg",gamerTagViewerJTableDiv="#viewGamerTagsDiv",expandedCurEventsFilterGroups=[],expandedEvtMgrFilterGroups=[],lastWindowWidth=-1,lastWindowHeight=-1;